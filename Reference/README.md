# SM2参考算法



### 关于这个算法的一些细节问题

#### 1、椭圆曲线的计算

- 点乘的相关函数是EccPoint_mult，这里跟点相乘的是16进制的数值，与想象的有些出入
- 在每进行一次EccPoint的乘法运算时，都会进行一次revert(还原)的操作
- 算法内部提供了XYcZ_add()函数来实现P+Q P-Q的运算
- 也提供了XYcZ_initial_double()函数来实现2P的运算
- 算法中没有直接给出椭圆曲线的加法运算，作者结合可变长整数的运算函数将加法运算的过程展现在验证算法中(详情在sm2.c的1089行，快速搜索: Calculate l_sum)
- 根据作者的模板，我们可以自行推导出椭圆曲线的加法运算过程
- 但是并没有提供椭圆曲线的减法运算过程，如何实现减法运算还有待研究
- 可能就是在加法运算的模板上将vli_modAdd修改为vli_modSub，有待验证(2021-11-19 17:13)


#### 2、可变长整数的计算

- 可变长整数相关的计算函数以vli_开头
- 所有的计算都需要提前开辟一段空间来存储结果，然后再以参数的形式传入函数中参与计算


#### 3、内存申请和释放

- 由于参考算法用的是C语言，没有new delte的机制，并且也没有对内存进行有效管理(申请完释放的问题)
- 在这个算法的基础上，我们可以改进部分代码，对已申请并且使用完的堆内存进行有效的释放(但是这样还是回归到一个问题：无法在C语言环境下兼容)